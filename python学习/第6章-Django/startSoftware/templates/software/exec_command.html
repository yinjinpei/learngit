{% extends 'software_base.html' %}

{% block title %}添加常用应用快捷键{% endblock %}
{% block scripts %}
<script src="/static/js/jquery-3.3.1.js"></script>
<!--<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>-->
<!--<script src="http://code.jquery.com/jquery-1.12.4.min.js"></script>-->
<script type="text/javascript">
    $(function () {
        $('#backup_all').click(function () {
            /*创建socket连接*/
            var socket = new WebSocket("ws://" + window.location.host + "/exec_command");
            console.log(socket);
            socket.onopen = function () {
                console.log('WebSocket open');//成功连接上Websocket
                socket.send($('#backup_all').val());//发送数据到服务端
            };
            socket.onmessage = function (e) {
                console.log('message: ' + e.data);//打印服务端返回的数据
                // $('#messagecontainer').prepend('<p><pre>' + e.data + '</pre></p>');
                $('#messagecontainer').append(e.data+'<br/>');
            };
        });
    });
</script>

{% endblock %}
{% block content %}
<h1>您好,{{ request.session.user_name }}！欢迎回来！</h1>
<hr>
<h1>exec_command</h1>

<button style="margin: 20px;height: 40px;background-color: #00ff00;" type="button" id="backup_all" value="backup_all">
    执行Shell脚本
</button>

<h3 style="margin: 20px;">脚本执行结果:</h3>
<div id="messagecontainer" style="margin: 20px;">
</div>

<hr>
<a href="/">返回首页</a>
<hr>
<a href="#">回到顶部</a>
{% endblock %}
